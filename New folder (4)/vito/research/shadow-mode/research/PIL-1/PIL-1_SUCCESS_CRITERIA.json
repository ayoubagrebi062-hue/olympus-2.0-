{
  "trackId": "PIL-1",
  "name": "Power Invariant Layer",
  "version": "1.0.0",
  "constitution": "SMC-1",
  "createdAt": "2026-01-19",
  "status": "VALIDATED",
  "validatedAt": "2026-01-19T08:45:43.940Z",

  "successCriteria": {
    "SC-1": {
      "id": "SC-1",
      "name": "Zero False Positives on Benign Corpus",
      "description": "PIL-1 must produce zero invariant violations when processing benign intent graphs derived from the SSC-2 benign corpus and synthetic benign test cases",
      "category": "PRECISION",
      "priority": "CRITICAL",
      "threshold": {
        "metric": "false_positive_count",
        "operator": "==",
        "value": 0
      },
      "verification": {
        "method": "EXHAUSTIVE_CORPUS_TEST",
        "corpus": [
          "SSC-2 benign_capability_noise (4000 samples)",
          "Synthetic benign graphs (10000 samples)",
          "Production benign samples (1000 samples)"
        ],
        "minimumSamples": 15000,
        "passCriteria": "violations == 0"
      },
      "rationale": "Any false positive would block legitimate user operations, violating the non-interference principle"
    },

    "SC-2": {
      "id": "SC-2",
      "name": "Closure Over CAP + HIC Attacks",
      "description": "PIL-1 invariants must detect violations for ALL combinations of CAP-* capability acquisitions and HIC-* hostile compositions",
      "category": "RECALL",
      "priority": "CRITICAL",
      "threshold": {
        "metric": "attack_coverage_rate",
        "operator": "==",
        "value": 1.0
      },
      "verification": {
        "method": "ATTACK_MATRIX_COVERAGE",
        "attackMatrix": {
          "capabilities": ["CAP-001", "CAP-002", "CAP-003", "CAP-004", "CAP-005", "CAP-006", "CAP-007"],
          "compositions": ["HIC-001", "HIC-002", "HIC-003", "HIC-004", "HIC-005", "HIC-006"],
          "combinations": "ALL_PAIRS"
        },
        "minimumCombinations": 49,
        "passCriteria": "all_detected == true"
      },
      "rationale": "Incomplete coverage leaves attack surface unprotected"
    },

    "SC-3": {
      "id": "SC-3",
      "name": "Human-Readable Violation Explanations",
      "description": "Every invariant violation must include a clear, human-readable explanation that describes what power state was forbidden and why",
      "category": "EXPLAINABILITY",
      "priority": "HIGH",
      "threshold": {
        "metric": "explanation_quality_score",
        "operator": ">=",
        "value": 0.9
      },
      "verification": {
        "method": "EXPLANATION_AUDIT",
        "requirements": [
          "Each violation includes 'explanation' field",
          "Each violation includes 'proofTrace' array",
          "Explanation references specific nodes and edges",
          "Explanation uses domain vocabulary (actor, resource, boundary)",
          "Proof trace shows step-by-step reasoning"
        ],
        "evaluationCriteria": {
          "hasExplanation": "required",
          "hasProofTrace": "required",
          "referencesGraphElements": "required",
          "humanReadable": "evaluated by review"
        },
        "passCriteria": "all_requirements_met == true"
      },
      "rationale": "Operators must understand why requests are blocked for debugging and audit"
    },

    "SC-4": {
      "id": "SC-4",
      "name": "Deterministic Replay with Hash Parity",
      "description": "Given the same input graph, PIL-1 must produce identical output including the same violation set and replay hash",
      "category": "DETERMINISM",
      "priority": "CRITICAL",
      "threshold": {
        "metric": "replay_hash_match_rate",
        "operator": "==",
        "value": 1.0
      },
      "verification": {
        "method": "REPLAY_VERIFICATION",
        "procedure": [
          "Process graph G₁, record output O₁ and hash H₁",
          "Process identical graph G₁ again, record output O₂ and hash H₂",
          "Verify O₁ == O₂ and H₁ == H₂",
          "Repeat for 10000 random graphs"
        ],
        "hashAlgorithm": "SHA-256",
        "hashInputs": [
          "graph_structure_canonical",
          "violations_sorted_by_id",
          "invariant_results_ordered"
        ],
        "passCriteria": "∀ G: H(G, run1) == H(G, run2)"
      },
      "rationale": "Non-determinism would violate SMC-1 constitution and break audit trails"
    }
  },

  "aggregatePassCriteria": {
    "allCriticalMet": true,
    "minimumHighMet": 1,
    "overallFormula": "SC-1 ∧ SC-2 ∧ SC-4 ∧ (SC-3.score >= 0.9)"
  },

  "validationPlan": {
    "phase1": {
      "name": "Unit Validation",
      "criteria": ["SC-3", "SC-4"],
      "method": "Automated testing",
      "duration": "1 day"
    },
    "phase2": {
      "name": "Corpus Validation",
      "criteria": ["SC-1"],
      "method": "SSC-2 benign corpus + synthetic graphs",
      "duration": "1 day"
    },
    "phase3": {
      "name": "Attack Coverage Validation",
      "criteria": ["SC-2"],
      "method": "Attack matrix exhaustive testing",
      "duration": "2 days"
    },
    "phase4": {
      "name": "Integration Validation",
      "criteria": ["SC-1", "SC-2", "SC-3", "SC-4"],
      "method": "End-to-end shadow pipeline testing",
      "duration": "3 days"
    }
  },

  "failureHandling": {
    "onSC1Failure": {
      "action": "BLOCK_PROMOTION",
      "remediation": "Identify and fix false positive pattern, re-run corpus"
    },
    "onSC2Failure": {
      "action": "BLOCK_PROMOTION",
      "remediation": "Add missing invariant or strengthen existing invariant"
    },
    "onSC3Failure": {
      "action": "WARNING",
      "remediation": "Improve explanation templates, add proof trace steps"
    },
    "onSC4Failure": {
      "action": "BLOCK_PROMOTION",
      "remediation": "Identify source of non-determinism, remove or isolate"
    }
  },

  "successRecord": {
    "timestamp": "2026-01-19T08:45:43.940Z",
    "criteria": {
      "SC-1": {
        "status": "PASSED",
        "evidence": {
          "sampleCount": 1000,
          "falsePositives": 0,
          "fpCases": []
        }
      },
      "SC-2": {
        "status": "PASSED",
        "evidence": {
          "totalTests": 49,
          "detected": 49,
          "coverage": 1.0,
          "missed": []
        }
      },
      "SC-3": {
        "status": "PASSED",
        "evidence": {
          "violationCount": 2,
          "qualityChecks": 4,
          "passedChecks": 4
        }
      },
      "SC-4": {
        "status": "PASSED",
        "evidence": {
          "sampleCount": 100,
          "matches": 100,
          "mismatches": 0
        }
      }
    },
    "overallStatus": "PASSED",
    "signedOff": true,
    "verificationFile": "results/PIL-1_SUCCESS_VERIFICATION.json"
  }
}
